<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    {% load static %}
    <link rel="stylesheet" type="text/css" href="{% static 'core/css/base.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'health/css/plan-detail.css' %}">

    <title>Plan Details</title>
</head>

<body>

    <!-- admin shit -->
     <!-- {% if can_manage %}
        <p>
            <a href="{% url 'plan-update' slug=plan.slug %}" class="button warning">Edit</a>
            <a href="{% url 'plan-delete' slug=plan.slug %}" class="button danger">Delete</a>
        </p>
    {% endif %} -->
    {% include 'includes/navigation.html' %}

    <div class="container stack-large">
        <div class="flexbox">
            <div class="column">
                <div class="plan-cover">
                    <img src="{{ plan.featured_image.url }}" />
                </div>
            </div>
            <div class="column">
                <div class="plan-metadata stack-small">
                    <h2 class="plan-title">{{ plan.title }}</h2>
                    <p class="author">by <a class="link red" href="{% url 'member-profile' plan.author %}">{{ plan.author }}</a></p>
                    <p class="date">{{ plan.views }} views {{ plan.created_at }}</p>
                    <p class="desc">{{ plan.excerpt }}</p>
                </div>
            </div>
        </div>
        <div class="flexbox plan-header">
            
            <div class="column">
                <div class="plan-metadata">
                    
                </div>
            </div>
        </div>
        <div class="stack-large">
            <div class="action-links">
                {% if plan.type == 'strength_and_conditioning' %}
                    <a class="link red" href="{% url 'exercise-create' slug=plan.slug %}">+ add exercise</a>
                {% endif %}
                {% if plan.type == 'nutrition' %}
                    <a class="link red" href="{% url 'meal-create' slug=plan.slug %}">+ add meal</a>
                {% endif %}
                <a class="link red" href="{% url 'plan-update' slug=plan.slug %}">edit plan info</a>
            </div>

            <!-- RICH TEXT CONTENT -->
            {% if plan.content %}
            <div class="content stack-small">
                <div class="section-header border">
                    <h2>Content</h2>
                </div>

                <div>{{ plan.content | safe }}</div>
            </div>
            {% else %}
                <div>This plan does not have a rich text content.</div>
            {% endif %}

            <!-- EXERCISES -->
            {% if exercises %}
            <div class="exercises stack-small">
                <div class="section-header border">
                    <h2>Exercises</h2>
                </div>
                <ul class="exercise-list">
                    {% for exercise in exercises %}
                        <li class="list-item">
                            <div class="exercise-name">{{ exercise.movement.name }}</div>
                            <div class="exercise-image">
                                <img src="{{ exercise.movement.image.url }}" alt="exercise visual"/>
                            </div>
                            <div class="exercise-meta"><span class="highlight">{{ exercise.sets }}</span> sets of <span class="highlight">{{ exercise.reps }}</span></div>
                        </li>
                        {% empty %}
                        <p>No exercises have been added to this plan yet.</p>
                    {% endfor %}
                </ul>
            </div>
            {% else %}
            <div>This plan does not have any exercises.</div>
            {% endif %}
            
            <!-- MEALS -->
            {% if meals %}
            <div class="exercises stack-small">
                <div class="section-header border">
                    <h2>Meals</h2>
                </div>
            </div>
            {% else %}
                <div>This plan does not have any meals.</div>
            {% endif %}

        </div>
    </div>
    {% include 'includes/footer.html' %}
</body>

</html>